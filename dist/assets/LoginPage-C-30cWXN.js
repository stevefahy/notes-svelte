import{p as te,s as g,b as se,c as l,d as O,g as e,e as i,t as ae,f as k,h as S,j as I,k as M,l as oe,m as p,n as G,a as ie,o as ne,q as r,u as le,v as ue,w as P,x as Y,A as ce,y as ve,z as de,B as me}from"./index-gzXAQREY.js";import{b as L,E as _e}from"./ErrorAlert-GxBBq72h.js";import{v as fe,a as ge,b as pe}from"./vuetify-classes-DOjo5YWf.js";var be=Y('<div class="control svelte-qr5qwk"><label for="username" class="svelte-qr5qwk">Your Name</label> <input type="text" id="username" required="" placeholder="Username" autocomplete="username"/></div>'),qe=Y('<section class="auth svelte-qr5qwk"><div><h2> </h2> <div><form novalidate=""><!> <div class="control svelte-qr5qwk"><label for="email" class="svelte-qr5qwk">Your Email</label> <input type="email" id="email" required="" placeholder="Email" autocomplete="email"/></div> <div class="control svelte-qr5qwk"><label for="password" class="svelte-qr5qwk">Your Password</label> <input type="password" id="password" required=""/></div> <div class="actions svelte-qr5qwk"><button class="btn-contained v-btn v-btn--elevated v-theme--myCustomLightTheme bg-secondary v-btn--density-default v-btn--size-default v-btn--variant-elevated contained medium svelte-qr5qwk" type="submit"> </button> <button class="btn-text svelte-qr5qwk" type="button"> </button></div></form> <!></div></div></section>');function Ae(H,V){te(V,!0);const W=()=>ve(de,"$querystring",z),[z,F]=ne(),v=ce;let n=g(!0),u=g(!1),m=g(""),c=g(""),d=g(""),a=g(se({error_state:!1,error_severity:"",message:""}));const N=()=>{const t=W()||"";return new URLSearchParams(t).get("redirect")||v.DEFAULT_PAGE},j=()=>{_(),r(n,!e(n)),r(m,""),r(c,""),r(d,"")},_=()=>{r(a,{error_state:!1,error_severity:"",message:""},!0)},x=t=>{if(t.includes("username")&&e(m)&&e(m).length<2)return r(a,{error_state:!0,error_severity:"error",message:v.SIGNUP_INVALID_USERNAME},!0),!1;if(t.includes("email")&&(!e(c)||!e(c).includes("@")||!e(c).includes(".")))return r(a,{error_state:!0,error_severity:"error",message:v.SIGNUP_INVALID_EMAIL},!0),!1;if(t.includes("password")){const o=e(d).trim().length;if(!e(d)||o<v.PASSWORD_MIN)return r(a,{error_state:!0,error_severity:"error",message:v.SIGNUP_INVALID_PASSWORD},!0),!1;if(o>v.PASSWORD_MAX)return r(a,{error_state:!0,error_severity:"error",message:v.CHANGE_PASS_TOO_MANY},!0),!1}return!0},B=async t=>{t.preventDefault(),r(u,!0),r(a,{error_state:!1,error_severity:"",message:""},!0);const o=le(ue),f=o?.onLogin,A=o?.onRegister;if(e(n)){if(!x(["email","password"])){r(u,!1);return}try{const s=await f?.(e(c),e(d));r(u,!1),s&&!("error"in s)?P(N()):s&&"error"in s&&r(a,{error_state:!0,error_severity:"error",message:s.error??"An error occurred"},!0)}catch(s){r(u,!1),r(a,{error_state:!0,error_severity:"error",message:String(s)},!0)}}else{if(!x(["username","email","password"])){r(u,!1);return}try{const s=await A?.(e(m),e(c),e(d),"svelte");if(r(u,!1),!s)return;if("error"in s){r(a,{error_state:!0,error_severity:"error",message:s.error??"An error occurred"},!0);return}"success"in s&&s.success&&s.notebookID&&s.noteID?P(`/notebook/${s.notebookID}/${s.noteID}`):P(N())}catch(s){r(u,!1),r(a,{error_state:!0,error_severity:"error",message:String(s)},!0)}}};var D=qe(),E=i(D),q=i(E),X=i(q),C=l(q,2),w=i(C),$=i(w);{var J=t=>{var o=be(),f=l(i(o),2);p("input",f,_),L(f,()=>e(m),A=>r(m,A)),G(t,o)};O($,t=>{e(n)||t(J)})}var R=l($,2),h=l(i(R),2),T=l(R,2),b=l(i(T),2),K=l(T,2),y=i(K),Q=i(y),U=l(y,2),Z=i(U),ee=l(w,2);{var re=t=>{_e(t,{get error_state(){return e(a).error_state},get message(){return e(a).message},get error_severity(){return e(a).error_severity}})};O(ee,t=>{e(a).error_state&&t(re)})}ae((t,o,f)=>{S(E,1,t,"svelte-qr5qwk"),S(q,1,o,"svelte-qr5qwk"),I(X,e(n)?"Login":"Sign Up"),S(C,1,f,"svelte-qr5qwk"),M(b,"placeholder",e(n)?"Password":"Password (7-10 characters)"),M(b,"autocomplete",e(n)?"current-password":"new-password"),y.disabled=e(u),I(Q,e(n)?"Login":"Create Account"),I(Z,e(n)?"Create new account":"Login with existing account")},[()=>k(fe("card")),()=>k(ge("header")),()=>k(pe("card-content"))]),oe("submit",w,B),p("change",h,_),p("input",h,_),L(h,()=>e(c),t=>r(c,t)),p("change",b,_),p("input",b,_),L(b,()=>e(d),t=>r(d,t)),p("click",U,j),G(H,D),ie(),F()}me(["input","change","click"]);export{Ae as default};
