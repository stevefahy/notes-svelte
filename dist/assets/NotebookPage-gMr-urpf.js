const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DIhGLwtw.js","assets/index-D-V4zERQ.js","assets/index-fi9NzBlx.css","assets/AddNotebookForm-CA0dCu1b.js","assets/ErrorAlert-G22uhqMO.js","assets/ErrorAlert-DZvNB_QY.css","assets/vuetify-classes-DOjo5YWf.js","assets/AddNotebookForm-BtUzU4dZ.css","assets/ViewNoteMarkdown-D_YEOq2p.js","assets/saveNote-BCsjjeXU.js","assets/addNotebook-6eCq7xKh.js","assets/changeUsername-B6NKFOrn.js","assets/FooterView-DEofwuiu.js","assets/FooterView-DK_MiM7N.css"])))=>i.map(i=>d[i]);
import{K as F,A as it,z as ft,p as lt,c as E,e as v,g as t,G as pt,t as tt,f as nt,h as st,l as qt,o as d,m as g,a as dt,s as $,F as W,w as A,j as kt,L as Gt,b as At,M as bt,H as St,d as j,k as _t,N as Kt,O as Qt,u as U,D as M,I as Xt,B as ot,x as vt,P as rt,n as Yt,q as z,v as at,C as J,Q as Zt,R as te,_ as ee}from"./index-D-V4zERQ.js";import{e as Ot,b as oe,D as re,g as ae,A as ne}from"./AddNotebookForm-CA0dCu1b.js";import{V as se,m as ie,g as le}from"./ViewNoteMarkdown-D_YEOq2p.js";import{F as Dt}from"./FooterView-DEofwuiu.js";import{v as Pt,b as Tt}from"./vuetify-classes-DOjo5YWf.js";const de={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},ce=de,ue=it,_e=async(N,u)=>{let a;try{if(a=await fetch((ce.VITE_API_ENDPOINT||"")+`api/data/notes/${u}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`}}),a.status===404)throw new Error(`${a.url} Not Found.`)}catch(o){return{error:F(o)}}let i;try{if(i=await a.json(),i===null)return{error:`${ue.NOTES_ERROR}`}}catch(o){return{error:F(o)}}return i&&"error"in i&&i.error?{error:i.error}:i},ve={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},be=ve,fe=it,pe=async(N,u)=>{let a;const i={notebookID:u};try{if(a=await fetch((be.VITE_API_ENDPOINT||"")+"api/data/delete-notebook",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify(i)}),a.status===404)throw new Error(`${a.url} Not Found.`)}catch(n){return{error:F(n)}}let o;try{if(o=await a.json(),o===null)return{error:`${fe.NOTEBOOK_DELETE_ERROR}`}}catch(n){return{error:F(n)}}return o&&"error"in o&&o.error?{error:o.error}:o},ke={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},he=ke,me=it,Ne=async(N,u)=>{let a;const i={note_ids:u};try{if(a=await fetch((he.VITE_API_ENDPOINT||"")+"api/data/delete-notes",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify(i)}),a.status===404)throw new Error(`${a.url} Not Found.`)}catch(n){return{error:F(n)}}let o;try{if(o=await a.json(),o===null)return{error:`${me.NOTES_DELETE_ERROR}`}}catch(n){return{error:F(n)}}return o&&"error"in o&&o.error?{error:o.error}:o},we={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},ge=we,Ee=it,ye=async(N,u,a,i)=>{let o;const n={notes:a,notebookID:u,latestUpdatedNote:i};try{if(o=await fetch((ge.VITE_API_ENDPOINT||"")+"api/data/move-notes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify(n)}),o.status===404)throw new Error(`${o.url} Not Found.`)}catch(_){return{error:F(_)}}let k;try{if(k=await o.json(),k===null)return{error:`${Ee.NOTES_ERROR}`}}catch(_){return{error:F(_)}}return k&&"error"in k&&k.error?{error:k.error}:k};var De=A("<option> </option>"),Ae=A('<div class="modal-container svelte-1lcsh5s"><div class="modal-overlay svelte-1lcsh5s" role="button" tabindex="0" aria-label="Close dialog"></div> <div role="dialog" aria-modal="true" aria-labelledby="move-notebook-title" tabindex="-1"><div><h2 id="move-notebook-title" class="dialogue-title">Move to Notebook</h2> <form id="move-notebook-form" class="form svelte-1lcsh5s"><div class="control svelte-1lcsh5s"><label for="notebooks-select" class="svelte-1lcsh5s">Name</label> <select id="notebooks-select" class="select_dialogue svelte-1lcsh5s"><option disabled="">Select a notebook...</option><!></select></div></form> <div class="button_row svelte-1lcsh5s"><div class="action svelte-1lcsh5s"><div class="move"><button type="submit" form="move-notebook-form" class="btn-contained v-btn--size-default svelte-1lcsh5s" aria-label="Move Note button">Move Note</button></div> <div class="cancel"><button type="button" class="btn-contained v-btn--size-default svelte-1lcsh5s" aria-label="Cancel button"><span class="icon_text svelte-1lcsh5s"><span class="material-symbols-outlined button_icon white svelte-1lcsh5s">cancel</span> Cancel</span></button></div></div></div></div></div></div>');function Se(N,u){lt(u,!0);let a=$(""),i=W(()=>t(a)!==""&&t(a)!=="default");const o=W(()=>{const s=[...u.notebooks];return s.sort((y,O)=>{const Y=y.updatedAt==="No date"||!y.updatedAt?"December 17, 1995":y.updatedAt,K=O.updatedAt==="No date"||!O.updatedAt?"December 17, 1995":O.updatedAt;return new Date(Y)>new Date(K)?-1:1}),s}),n=W(()=>t(o).filter(s=>s._id!==u.currentNotebookId)),k=s=>{s.preventDefault(),s.stopPropagation(),u.onCancel()},_=async s=>{s.preventDefault(),s.stopPropagation(),!(!t(a)||!t(i))&&await u.onMoveNotes(t(a))};function p(s){return s.focus(),{}}var c=Ae(),h=v(c);h.__click=s=>k(s),h.__keydown=s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),k(s))};var w=E(h,2);w.__keydown=s=>s.key==="Escape"&&k(s);var T=v(w),C=E(v(T),2),x=v(C),I=E(v(x),2),V=v(I);V.value=V.__value="";var S=E(V);Ot(S,17,()=>t(n),s=>s._id,(s,y)=>{var O=De(),Y=v(O),K={};tt(()=>{kt(Y,t(y).notebook_name),K!==(K=t(y)._id)&&(O.value=(O.__value=t(y)._id)??"")}),g(s,O)});var X=E(C,2),q=v(X),G=v(q),H=v(G),m=E(G,2),L=v(m);L.__click=k,pt(w,s=>p?.(s)),tt((s,y)=>{st(w,1,s,"svelte-1lcsh5s"),st(T,1,y,"svelte-1lcsh5s"),H.disabled=!t(i)},[()=>nt(Pt("card","modal-dialog","dialogue_container")),()=>nt(Tt())]),qt("submit",C,_),oe(I,()=>t(a),s=>d(a,s)),g(N,c),dt()}ft(["click","keydown"]);function Oe(N,u=10){if(!N?.trim())return"";const a=N.split(`
`),i=[];let o=0,n=[];for(;o<a.length&&i.length<u;){const k=a[o],_=k.trim();if(_.startsWith("```")){for(n.length>0&&(i.push(n.join(`
`)),n=[]),n=[k],o++;o<a.length&&!a[o].trim().startsWith("```");)n.push(a[o]),o++;o<a.length&&(n.push(a[o]),o++),i.push(n.join(`
`)),n=[];continue}if(_===""){n.length>0&&(i.push(n.join(`
`)),n=[]),o++;continue}const p=/^#{1,6}\s/.test(_),c=/^[-*+]\s/.test(_)||/^\d+\.\s/.test(_),h=_.startsWith(">"),w=/^\|/.test(_);(p||c||h||w)&&n.length>0&&(i.push(n.join(`
`)),n=[]),n.push(k),o++}return n.length>0&&i.push(n.join(`
`)),i.slice(0,u).join(`

`)}var Pe=A('<div class="box svelte-ebwjus"><article class="viewnote_content viewnote_thumb"><!></article></div>');function Te(N,u){lt(u,!0);const a=W(()=>Oe(ie(u.text).content??""));var i=Pe(),o=v(i),n=v(o);se(n,{get viewText(){return t(a)},disableLinks:!0}),g(N,i),dt()}var Ie=A('<div class="thumb_select_outer svelte-uaddfd"><div class="thumb_select svelte-uaddfd"><input type="checkbox" name="Status"/></div></div>'),Re=A('<li class="notebook_list_bg svelte-uaddfd"><div class="thumb_outer svelte-uaddfd"><a class="thumb_outer_link svelte-uaddfd"><div class="edit_link svelte-uaddfd" role="button"><div><div><div class="thumb_image svelte-uaddfd"><!></div> <div class="date_format date_format_notes"> </div></div></div></div></a> <!></div></li>'),xe=A('<ul class="notes_list svelte-uaddfd"></ul>');function Ce(N,u){lt(u,!0);let a=Gt(u,"onNotesEdit",3,!1),i=$(At({})),o=!1;bt(()=>{const p=!!u.onClearNotesEdit;p&&!o&&(d(i,{},!0),u.onNotesSelected?.({selected:[]})),o=p});const n=(p,c)=>{d(i,{...t(i),[p]:c},!0);const h=Object.entries(t(i)).filter(([,w])=>w).map(([w])=>w);u.onNotesSelected?.({selected:h})},k=(p,c)=>{c.stopPropagation();const h=c.target;n(p,h.checked)};var _=xe();Ot(_,21,()=>u.notes,p=>p._id,(p,c)=>{var h=Re(),w=v(h),T=v(w);T.__click=m=>a()&&m.preventDefault();var C=v(T);C.__click=m=>{a()&&(m.preventDefault(),n(t(c)._id,!t(i)[t(c)._id]))},C.__keydown=m=>{a()&&(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),n(t(c)._id,!t(i)[t(c)._id]))};var x=v(C),I=v(x),V=v(I),S=v(V);Te(S,{get text(){return t(c).note}});var X=E(V,2),q=v(X);pt(T,m=>St?.(m));var G=E(T,2);{var H=m=>{var L=Ie(),s=v(L),y=v(s);y.__change=O=>k(t(c)._id,O),y.__click=O=>O.stopPropagation(),tt(()=>{Kt(y,t(c)._id),_t(y,"id",`input_${t(c)._id??""}`),Qt(y,t(i)[t(c)._id]??!1)}),g(m,L)};j(G,m=>{a()&&m(H)})}tt((m,L,s)=>{_t(T,"href",`/notebook/${t(c).notebook??""}/${t(c)._id??""}`),_t(C,"tabindex",a()?0:-1),st(x,1,m,"svelte-uaddfd"),st(I,1,L,"svelte-uaddfd"),kt(q,s)},[()=>nt(Pt("note_list_card")),()=>nt(Tt("cardcontent")),()=>re(t(c).updatedAt??"")]),g(p,h)}),g(N,_),dt()}ft(["click","keydown","change"]);var $e=A('<div class="loading_routes">Loading...</div>'),Ve=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">arrow_back</span> Back to Notebooks</span></button>'),Me=A('<div class="page_scrollable_header_breadcrumb_footer_list"><div class="loading_routes error-state"><p> </p> <a href="/notebooks" class="back-link">Back to Notebooks</a></div></div> <!>',1),je=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">note_add</span> Add Note</span></button>'),Le=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">edit</span> Edit Notes</span></button>'),Be=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">delete</span> Delete Notebook</span></button>'),Ue=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">delete</span> Delete</span></button>'),Fe=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white symbol_size">flip_to_front</span> Move</span></button>'),He=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">cancel</span> Cancel</span></button>'),ze=A("<!> <!> <!> <!> <!> <!>",1),Je=A('<div class="page_scrollable_header_breadcrumb_footer_list"><!> <!> <!></div> <!>',1);function We(N,u){lt(u,!0);const a=()=>vt(Zt,"$paramsStore",n),i=()=>vt(te,"$location",n),o=()=>vt(rt,"$notebookEditStore",n),[n,k]=Yt(),_=W(()=>{const r=(u.params??a())?.notebookId;if(r)return r;const e=i();if(e){const R=/^\/notebook\/([^/]+)/.exec(e);if(R?.[1])return R[1]}const l=typeof window<"u"?window.location.hash:"";return/#?\/notebook\/([^/]+)/.exec(l)?.[1]??null});let p=$(null),c=$(null),h=$(null),w=$(!1),T=$(!1),C=$(!1),x=$(At([])),I=$(!1),V=$(!1),S=$(null);const X=r=>{d(x,r.selected,!0)},q=r=>{const e=r.map(l=>({...l,updatedAt:l.updatedAt==="No date"||!l.updatedAt?"December 17, 1995 03:24:00":l.updatedAt}));return e.sort((l,b)=>new Date(l.updatedAt)>new Date(b.updatedAt)?1:-1),e.reverse()},G=async r=>{try{const e=z(U).token;if(!e){d(S,"Session expired. Redirecting to login."),d(T,!0),at("/login");return}const l=J(await le(e,r));if(!l.ok){M(l.error??"Unknown error"),d(S,l.error??null,!0),d(T,!0);return}l.data.notebook&&(d(c,l.data.notebook,!0),rt.update(b=>({...b,edited:l.data.notebook})))}catch(e){d(S,e instanceof Error?e.message:String(e),!0),M(t(S))}finally{d(T,!0)}},H=async r=>{try{const e=z(U).token;if(!e){d(w,!0);return}const l=J(await _e(e,r));if(!l.ok)M(l.error??"Unknown error"),d(S,l.error??null,!0);else if(l.data.notes){const b=Array.isArray(l.data.notes)?l.data.notes:[];d(p,q(b),!0)}else d(p,[],!0)}catch(e){d(S,e instanceof Error?e.message:String(e),!0),M(t(S))}finally{d(w,!0)}},m=async()=>{try{const r=z(U).token;if(!r)return;const e=J(await ae(r));if(!e.ok){M(e.error??"Unknown error");return}e.data.notebooks?d(h,Array.isArray(e.data.notebooks)?e.data.notebooks:[],!0):d(h,[],!0)}catch(r){M(r instanceof Error?r.message:String(r))}},L=()=>{t(_)&&at(`/notebook/${t(_)}/create-note`)},s=async()=>{if(!confirm("Delete this notebook?"))return;const r=z(U).token;if(!r||!t(_))return;const e=J(await pe(r,t(_)));if(!e.ok){M(e.error??"Unknown error");return}at("/notebooks")},y=()=>{d(I,!0)},O=()=>{d(I,!1),d(x,[],!0)},Y=()=>{d(V,!0)},K=()=>{d(V,!1)},It=async()=>{if(t(x).length===0)return;const r=z(U).token;if(!r)return;const e=J(await Ne(r,t(x)));if(!e.ok){M(e.error??"Unknown error");return}O(),t(_)&&await H(t(_))},Rt=()=>{d(C,!1),rt.update(r=>({...r,editing:!1}))},xt=async(r,e)=>{const l=z(U).token;if(!l||!t(c))return;const{editNotebook:b}=await ee(async()=>{const{editNotebook:B}=await import("./index-DIhGLwtw.js");return{editNotebook:B}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])),R=J(await b(l,t(c)._id,r,e,new Date().toISOString()));if(!R.ok){M(R.error??"Unknown error");return}R.data.notebook_edited&&(d(c,R.data.notebook_edited,!0),rt.update(B=>({...B,edited:R.data.notebook_edited,editing:!1})),d(C,!1))},Ct=r=>{const e=r.map(b=>t(p)?.find(R=>R._id===b)).filter(Boolean);return q(e)[0]?.updatedAt},$t=async r=>{const e=z(U).token;if(!e||!t(_)||t(x).length===0)return;const l=Ct(t(x)),b=J(await ye(e,r,t(x),l));if(!b.ok){M(b.error??"Unknown error");return}b.ok&&(d(V,!1),O(),t(_)&&await H(t(_)))};bt(()=>{o()?.editing&&d(C,!0)}),bt(()=>{const r=t(_);if(!r)return;d(w,!1),d(T,!1),d(S,null);let e=!1;return(async()=>{try{if(await U.getAuth(),e)return;await Promise.all([G(r),H(r),m()])}catch(b){e||(d(S,b instanceof Error?b.message:String(b),!0),M(t(S)),d(w,!0),d(T,!0))}})(),()=>{e=!0}});var ht=Xt(),Vt=ot(ht);{var Mt=r=>{var e=$e();g(r,e)},jt=r=>{var e=Me(),l=ot(e),b=v(l),R=v(b),B=v(R),ct=E(R,2);pt(ct,Z=>St?.(Z));var ut=E(l,2);Dt(ut,{children:(Z,mt)=>{var P=Ve();P.__click=()=>at("/notebooks"),g(Z,P)}}),tt(()=>kt(B,t(S))),g(r,e)},Lt=r=>{var e=Je(),l=ot(e),b=v(l);{var R=P=>{{let et=W(()=>t(p)??[]),Q=W(()=>!t(I));Ce(P,{get notes(){return t(et)},onNotesSelected:X,get onNotesEdit(){return t(I)},get onClearNotesEdit(){return t(Q)}})}};j(b,P=>{t(c)&&t(p)!==null&&P(R)})}var B=E(b,2);{var ct=P=>{Se(P,{get notebooks(){return t(h)},get currentNotebookId(){return t(_)},onMoveNotes:$t,onCancel:K})};j(B,P=>{t(V)&&t(h)&&P(ct)})}var ut=E(B,2);{var Z=P=>{ne(P,{method:"edit",get notebook(){return t(c)},onAddNotebook:async(et,Q)=>await xt(et,Q),onCancel:Rt})};j(ut,P=>{t(C)&&t(c)&&P(Z)})}var mt=E(l,2);Dt(mt,{children:(P,et)=>{var Q=ze(),Nt=ot(Q);{var Bt=f=>{var D=je();D.__click=L,g(f,D)};j(Nt,f=>{t(I)||f(Bt)})}var wt=E(Nt,2);{var Ut=f=>{var D=Le();D.__click=y,g(f,D)};j(wt,f=>{!t(I)&&(t(p)??[]).length>0&&f(Ut)})}var gt=E(wt,2);{var Ft=f=>{var D=Be();D.__click=s,g(f,D)};j(gt,f=>{(t(p)??[]).length<1&&f(Ft)})}var Et=E(gt,2);{var Ht=f=>{var D=Ue();D.__click=It,g(f,D)};j(Et,f=>{t(I)&&t(x).length>0&&f(Ht)})}var yt=E(Et,2);{var zt=f=>{var D=Fe();D.__click=Y,g(f,D)};j(yt,f=>{t(I)&&t(x).length>0&&t(h)&&t(h).length>1&&f(zt)})}var Jt=E(yt,2);{var Wt=f=>{var D=He();D.__click=O,g(f,D)};j(Jt,f=>{t(I)&&f(Wt)})}g(P,Q)}}),g(r,e)};j(Vt,r=>{!t(T)||!t(w)?r(Mt):t(S)?r(jt,1):r(Lt,!1)})}g(N,ht),dt(),k()}ft(["click"]);const Ye=Object.freeze(Object.defineProperty({__proto__:null,default:We},Symbol.toStringTag,{value:"Module"}));export{Ye as N,Ne as a,pe as d,_e as g,ye as m};
