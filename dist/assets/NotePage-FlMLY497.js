import{ai as qt,ap as zt,ao as Ht,ab as Ft,aq as Ot,p as Y,L as H,t as F,f as it,h as L,m as u,a as j,e as g,w as f,M as st,J as lt,g as t,k as ct,F as E,z as dt,u as U,o as d,I as Rt,B as W,d as y,s as T,q,C as z,P as Bt,D as J,A as Dt,c as I,v as Wt,E as Jt}from"./index-D-V4zERQ.js";import{V as Yt,g as jt}from"./ViewNoteMarkdown-D_YEOq2p.js";import{g as Gt,c as Kt,s as Qt}from"./saveNote-BCsjjeXU.js";import{F as Xt}from"./FooterView-DEofwuiu.js";import{v as vt,b as ut}from"./vuetify-classes-DOjo5YWf.js";function rt(r,e){return r===e||r?.[Ot]===e}function Zt(r={},e,v,n){return qt(()=>{var o,_;return zt(()=>{o=_,_=[],Ht(()=>{r!==v(..._)&&(e(r,..._),o&&rt(v(...o),r)&&e(null,...o))})}),()=>{Ft(()=>{_&&rt(v(..._),r)&&e(null,..._)})}}),r}let C=!1,M,V;const $t=()=>{bt(),M=document.querySelector("#edit"),V=document.querySelector("#view"),ee()},te=()=>{bt()},_t=(r,e)=>{const v=e.scrollHeight-e.clientHeight,n=r.scrollTop/(r.scrollHeight-r.clientHeight)*100;return v*(n/100)},bt=()=>{M?.removeEventListener("scroll",ft),V?.removeEventListener("scroll",wt)},ft=()=>{const r=V,v=_t(M,r),n=C;C=!1,!n&&(C=!0,r.scrollTop=v)},wt=()=>{const r=V,e=M,v=_t(r,e),n=C;C=!1,!n&&(C=!0,e.scrollTop=v)},ee=()=>{V!==null&&M!==null&&(M.addEventListener("scroll",ft),V.addEventListener("scroll",wt))};var oe=f('<div id="view"><div><div><!></div></div></div>');function ne(r,e){Y(e,!0);let v=H(e,"visible",3,!0),n=H(e,"splitScreen",3,!1);var o=oe(),_=g(o),k=g(_),s=g(k);Yt(s,{get viewText(){return e.viewText}}),F((x,p)=>{L(o,1,`view editnote_box ${n()?"view_split show":""} ${!n()&&v()?"show":""} ${!n()&&!v()?"hide":""}`),L(_,1,`note-card ${x??""}`),L(k,1,p)},[vt,()=>it(ut("cardcontent viewnote_content"))]),u(r,o),j()}var ae=f('<div id="edit"><div class="edit-note"><div><article><div class="viewnote_content editable" data-placeholder="Start writing..." role="textbox"></div></article></div></div></div>');function re(r,e){Y(e,!0);let v=H(e,"visible",3,!1),n=H(e,"splitScreen",3,!1),o;st(()=>{o&&e.loadedText!==void 0&&(o.innerText||"")!==e.loadedText&&(o.innerText=e.loadedText)});const _=()=>{o&&e.onUpdate(o.innerText||"")};lt(()=>{o&&!e.loadedText&&o.innerText===""&&o.focus()});const k=E(()=>v()||n());var s=ae(),x=g(s),p=g(x),m=g(p),b=g(m);b.__input=_,Zt(b,S=>o=S,()=>o),F((S,P)=>{L(s,1,`edit editnote_box ${n()?"view_split show":""} ${!n()&&t(k)?"show":""} ${!n()&&!t(k)?"hide":""}`),L(p,1,`note-card ${S??""}`),L(m,1,P),ct(b,"contenteditable",t(k)?"true":"false")},[vt,()=>it(ut("viewnote_content editor"))]),u(r,s),j()}dt(["input"]);var ie=f('<div class="loading_routes">Loading...</div>'),se=f('<button class="btn-footer btn-contained" type="button"><span class="material-symbols-outlined button_icon white">egg</span> Example</button>'),le=f('<button class="btn-footer btn-contained" type="button"><span class="material-symbols-outlined button_icon white">add_circle</span> Create Note</button>'),ce=f('<button class="btn-footer btn-contained v-btn v-btn--elevated v-theme--myCustomLightTheme bg-secondary v-btn--density-default v-btn--size-default v-btn--variant-elevated contained medium" type="button"><span class="material-symbols-outlined button_icon white">add_circle</span> Save Note</button>'),de=f('<span class="material-symbols-outlined white">visibility</span> View',1),ve=f('<span class="material-symbols-outlined white">edit</span> Edit',1),ue=f('<button class="btn-footer btn-contained v-btn v-btn--elevated v-theme--myCustomLightTheme bg-secondary v-btn--density-default v-btn--size-default v-btn--variant-elevated contained medium" type="button"><!></button>'),_e=f('<img src="/assets/images/split_screen_icon_single.png" alt="single" width="24" height="24"/>'),be=f('<img src="/assets/images/split_screen_icon_double.png" alt="double" width="24" height="24"/>'),fe=f('<button class="btn-footer btn-contained split_screen_btn" type="button" aria-label="Toggle split screen"><!></button>'),we=f("<!> <!> <!> <!> <!>",1),ge=f('<div class="page_scrollable_header_breadcrumb_footer"><div id="view_container"><!> <!></div></div> <!>',1);function Te(r,e){Y(e,!0);const v=Dt,n=E(()=>e.params?.notebookId),o=E(()=>e.params?.noteId);let _=T(null),k=T(null),s=T(""),x=T(""),p=T(!1),m=T(!0),b=T(!1),S=T(!1);const P=E(()=>t(o)==="create-note"),gt=E(()=>t(m)||t(b)),mt=E(()=>!t(m)||t(b)),ht=async()=>{const a=q(U).token;if(!a||!t(n))return;const i=z(await jt(a,t(n)));i.ok&&i.data.notebook&&(d(k,i.data.notebook,!0),Bt.update(h=>({...h,edited:i.data.notebook})))},pt=async()=>{if(t(o)==="create-note"){d(s,""),d(p,!0);return}const a=q(U).token;if(!a||!t(n)||!t(o))return;const i=z(await Gt(a,t(n),t(o)));if(!i.ok){J(i.error??"Unknown error");return}i.data.note&&(d(_,i.data.note,!0),d(s,i.data.note.note,!0),d(x,i.data.note.note,!0),d(p,!0))},G=E(()=>t(s)!==t(x)),kt=async a=>{const i=q(U).token;if(!i||!t(n))return;const h=z(await Kt(i,{notebookId:t(n),note:a}));if(!h.ok){J(h.error??"Unknown error");return}Wt(`/notebook/${t(n)}`)},K=async a=>{const i=q(U).token;if(!i||!t(n)||!t(o)||t(o)==="create-note")return;const h=z(await Qt(i,t(n),t(o),a));if(!h.ok){J(h.error??"Unknown error");return}d(x,a,!0),Jt.ShowSnack({n_status:!0,message:"Note Saved"})},Q=a=>{d(s,a,!0)},St=async()=>{t(G)&&await K(t(s)),d(m,!t(m))},yt=()=>{d(b,!t(b))},Tt=async()=>{try{const a=await fetch("/markdown/welcome_markdown_angular.md");a.ok?d(s,await a.text(),!0):d(s,`# Example Note

Start typing your note here...`)}catch{d(s,`# Example Note

Start typing your note here...`)}},O=()=>{d(S,window.innerWidth<v.SPLITSCREEN_MINIMUM_WIDTH),t(S)&&d(b,!1)};st(()=>{if(!t(p))return;const a=setTimeout(()=>$t(),500);return()=>{clearTimeout(a),te()}}),lt(()=>(O(),window.addEventListener("resize",O),(async()=>(await U.getAuth(),await ht(),await pt(),d(m,t(o)==="create-note")))(),()=>window.removeEventListener("resize",O)));var X=Rt(),xt=W(X);{var Nt=a=>{var i=ie();u(a,i)},Et=a=>{var i=ge(),h=W(i),Z=g(h),$=g(Z);ne($,{get viewText(){return t(s)},onEdit:A=>Q(A),get visible(){return t(mt)},get splitScreen(){return t(b)}});var Lt=I($,2);re(Lt,{get loadedText(){return t(s)},onUpdate:A=>Q(A),get visible(){return t(gt)},get splitScreen(){return t(b)}});var It=I(h,2);Xt(It,{children:(A,me)=>{var tt=we(),et=W(tt);{var Ct=l=>{var c=se();c.__click=Tt,u(l,c)};y(et,l=>{t(P)&&t(s).length===0&&l(Ct)})}var ot=I(et,2);{var Mt=l=>{var c=le();c.__click=()=>kt(t(s)),u(l,c)};y(ot,l=>{t(P)&&t(s).length>0&&l(Mt)})}var nt=I(ot,2);{var Vt=l=>{var c=ce();c.__click=()=>K(t(s)),u(l,c)};y(nt,l=>{!t(P)&&t(G)&&l(Vt)})}var at=I(nt,2);{var Pt=l=>{var c=ue();c.__click=St;var R=g(c);{var B=w=>{var N=de();u(w,N)},D=w=>{var N=ve();u(w,N)};y(R,w=>{t(m)?w(B):w(D,!1)})}F(()=>ct(c,"aria-label",t(m)?"Switch to View":"Switch to Edit")),u(l,c)};y(at,l=>{t(b)||l(Pt)})}var At=I(at,2);{var Ut=l=>{var c=fe();c.__click=yt;var R=g(c);{var B=w=>{var N=_e();u(w,N)},D=w=>{var N=be();u(w,N)};y(R,w=>{t(b)?w(B):w(D,!1)})}u(l,c)};y(At,l=>{t(S)||l(Ut)})}u(A,tt)}}),F(()=>L(Z,1,`view_container ${t(b)?"editnote_box_split":""}`)),u(a,i)};y(xt,a=>{t(p)?a(Et,!1):a(Nt)})}u(r,X),j()}dt(["click"]);export{Te as default};
