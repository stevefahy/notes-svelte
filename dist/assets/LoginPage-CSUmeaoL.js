import{p as re,s as g,b as te,c as l,d as U,g as e,e as i,t as se,f as A,h as k,j as S,k as O,l as ae,m as M,a as oe,n as ie,o as r,q as ne,u as le,v as I,w as G,A as ue,x as ce,y as ve,z as de}from"./index-D-V4zERQ.js";import{b as P,E as _e}from"./ErrorAlert-G22uhqMO.js";import{v as me,a as fe,b as ge}from"./vuetify-classes-DOjo5YWf.js";var pe=G('<div class="control svelte-qr5qwk"><label for="username" class="svelte-qr5qwk">Your Name</label> <input type="text" id="username" required="" placeholder="Username" autocomplete="username"/></div>'),be=G('<section class="auth svelte-qr5qwk"><div><h2> </h2> <div><form novalidate=""><!> <div class="control svelte-qr5qwk"><label for="email" class="svelte-qr5qwk">Your Email</label> <input type="email" id="email" required="" placeholder="Email" autocomplete="email"/></div> <div class="control svelte-qr5qwk"><label for="password" class="svelte-qr5qwk">Your Password</label> <input type="password" id="password" required=""/></div> <div class="actions svelte-qr5qwk"><button class="btn-contained v-btn v-btn--elevated v-theme--myCustomLightTheme bg-secondary v-btn--density-default v-btn--size-default v-btn--variant-elevated contained medium svelte-qr5qwk" type="submit"> </button> <button class="btn-text svelte-qr5qwk" type="button"> </button></div></form> <!></div></div></section>');function ye(Y,H){re(H,!0);const V=()=>ce(ve,"$querystring",W),[W,z]=ie(),v=ue;let n=g(!0),u=g(!1),_=g(""),c=g(""),d=g(""),a=g(te({error_state:!1,error_severity:"",message:""}));const L=()=>{const t=V()||"";return new URLSearchParams(t).get("redirect")||v.DEFAULT_PAGE},F=()=>{m(),r(n,!e(n)),r(_,""),r(c,""),r(d,"")},m=()=>{r(a,{error_state:!1,error_severity:"",message:""},!0)},N=t=>{if(t.includes("username")&&e(_)&&e(_).length<2)return r(a,{error_state:!0,error_severity:"error",message:v.SIGNUP_INVALID_USERNAME},!0),!1;if(t.includes("email")&&(!e(c)||!e(c).includes("@")||!e(c).includes(".")))return r(a,{error_state:!0,error_severity:"error",message:v.SIGNUP_INVALID_EMAIL},!0),!1;if(t.includes("password")){const o=e(d).trim().length;if(!e(d)||o<v.PASSWORD_MIN)return r(a,{error_state:!0,error_severity:"error",message:v.SIGNUP_INVALID_PASSWORD},!0),!1;if(o>v.PASSWORD_MAX)return r(a,{error_state:!0,error_severity:"error",message:v.CHANGE_PASS_TOO_MANY},!0),!1}return!0},j=async t=>{t.preventDefault(),r(u,!0),r(a,{error_state:!1,error_severity:"",message:""},!0);const o=ne(le),f=o?.onLogin,y=o?.onRegister;if(e(n)){if(!N(["email","password"])){r(u,!1);return}try{const s=await f?.(e(c),e(d));r(u,!1),s&&!("error"in s)?I(L()):s&&"error"in s&&r(a,{error_state:!0,error_severity:"error",message:s.error??"An error occurred"},!0)}catch(s){r(u,!1),r(a,{error_state:!0,error_severity:"error",message:String(s)},!0)}}else{if(!N(["username","email","password"])){r(u,!1);return}try{const s=await y?.(e(_),e(c),e(d),"svelte");if(r(u,!1),!s)return;if("error"in s){r(a,{error_state:!0,error_severity:"error",message:s.error??"An error occurred"},!0);return}"success"in s&&s.success&&s.notebookID&&s.noteID?I(`/notebook/${s.notebookID}/${s.noteID}`):I(L())}catch(s){r(u,!1),r(a,{error_state:!0,error_severity:"error",message:String(s)},!0)}}};var x=be(),D=i(x),b=i(D),X=i(b),E=l(b,2),q=i(E),C=i(q);{var B=t=>{var o=pe(),f=l(i(o),2);f.__input=m,P(f,()=>e(_),y=>r(_,y)),M(t,o)};U(C,t=>{e(n)||t(B)})}var $=l(C,2),w=l(i($),2);w.__change=m,w.__input=m;var R=l($,2),p=l(i(R),2);p.__change=m,p.__input=m;var J=l(R,2),h=i(J),K=i(h),T=l(h,2);T.__click=F;var Q=i(T),Z=l(q,2);{var ee=t=>{_e(t,{get error_state(){return e(a).error_state},get message(){return e(a).message},get error_severity(){return e(a).error_severity}})};U(Z,t=>{e(a).error_state&&t(ee)})}se((t,o,f)=>{k(D,1,t,"svelte-qr5qwk"),k(b,1,o,"svelte-qr5qwk"),S(X,e(n)?"Login":"Sign Up"),k(E,1,f,"svelte-qr5qwk"),O(p,"placeholder",e(n)?"Password":"Password (7-10 characters)"),O(p,"autocomplete",e(n)?"current-password":"new-password"),h.disabled=e(u),S(K,e(n)?"Login":"Create Account"),S(Q,e(n)?"Create new account":"Login with existing account")},[()=>A(me("card")),()=>A(fe("header")),()=>A(ge("card-content"))]),ae("submit",q,j),P(w,()=>e(c),t=>r(c,t)),P(p,()=>e(d),t=>r(d,t)),M(Y,x),oe(),z()}de(["input","change","click"]);export{ye as default};
