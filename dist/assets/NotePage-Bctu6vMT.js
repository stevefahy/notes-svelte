import{aj as Ht,aq as zt,ap as Ft,ac as Ot,ar as Rt,p as J,M as F,t as O,f as st,h as L,n as f,a as K,e as g,x as _,N as lt,K as ct,g as t,k as dt,m as I,G as E,B as vt,v as q,q as c,J as Bt,C as j,d as y,s as T,u as H,D as z,Q as Dt,E as G,A as Wt,c as C,w as jt,F as Gt}from"./index-gzXAQREY.js";import{V as Jt,g as Kt}from"./ViewNoteMarkdown-W4_zMct6.js";import{g as Qt,c as Yt,s as Xt}from"./saveNote-8kmoEnCa.js";import{F as Zt}from"./FooterView-BwsloGuJ.js";import{v as ut,b as ft}from"./vuetify-classes-DOjo5YWf.js";function it(r,e){return r===e||r?.[Rt]===e}function $t(r={},e,v,n){return Ht(()=>{var o,b;return zt(()=>{o=b,b=[],Ft(()=>{r!==v(...b)&&(e(r,...b),o&&it(v(...o),r)&&e(null,...o))})}),()=>{Ot(()=>{b&&it(v(...b),r)&&e(null,...b)})}}),r}let V=!1,M,P;const te=()=>{_t(),M=document.querySelector("#edit"),P=document.querySelector("#view"),oe()},ee=()=>{_t()},bt=(r,e)=>{const v=e.scrollHeight-e.clientHeight,n=r.scrollTop/(r.scrollHeight-r.clientHeight)*100;return v*(n/100)},_t=()=>{M?.removeEventListener("scroll",wt),P?.removeEventListener("scroll",gt)},wt=()=>{const r=P,v=bt(M,r),n=V;V=!1,!n&&(V=!0,r.scrollTop=v)},gt=()=>{const r=P,e=M,v=bt(r,e),n=V;V=!1,!n&&(V=!0,e.scrollTop=v)},oe=()=>{P!==null&&M!==null&&(M.addEventListener("scroll",wt),P.addEventListener("scroll",gt))};var ne=_('<div id="view"><div><div><!></div></div></div>');function ae(r,e){J(e,!0);let v=F(e,"visible",3,!0),n=F(e,"splitScreen",3,!1);var o=ne(),b=g(o),S=g(b),s=g(S);Jt(s,{get viewText(){return e.viewText},get onViewTextUpdate(){return e.onEdit}}),O((x,p)=>{L(o,1,`view editnote_box ${n()?"view_split show":""} ${!n()&&v()?"show":""} ${!n()&&!v()?"hide":""}`),L(b,1,`note-card ${x??""}`),L(S,1,p)},[ut,()=>st(ft("cardcontent viewnote_content"))]),f(r,o),K()}var re=_('<div id="edit"><div class="edit-note"><div><article><div class="viewnote_content editable" data-placeholder="Start writing..." role="textbox"></div></article></div></div></div>');function ie(r,e){J(e,!0);let v=F(e,"visible",3,!1),n=F(e,"splitScreen",3,!1),o;lt(()=>{o&&e.loadedText!==void 0&&(o.innerText||"")!==e.loadedText&&(o.innerText=e.loadedText)});const b=()=>{o&&e.onUpdate(o.innerText||"")};ct(()=>{o&&!e.loadedText&&o.innerText===""&&o.focus()});const S=E(()=>v()||n());var s=re(),x=g(s),p=g(x),m=g(p),u=g(m);$t(u,k=>o=k,()=>o),O((k,U)=>{L(s,1,`edit editnote_box ${n()?"view_split show":""} ${!n()&&t(S)?"show":""} ${!n()&&!t(S)?"hide":""}`),L(p,1,`note-card ${k??""}`),L(m,1,U),dt(u,"contenteditable",t(S)?"true":"false")},[ut,()=>st(ft("viewnote_content editor"))]),I("input",u,b),f(r,s),K()}vt(["input"]);var se=_('<div class="loading_routes">Loading...</div>'),le=_('<button class="btn-footer btn-contained" type="button"><span class="material-symbols-outlined button_icon white">egg</span> Example</button>'),ce=_('<button class="btn-footer btn-contained" type="button"><span class="material-symbols-outlined button_icon white">add_circle</span> Create Note</button>'),de=_('<button class="btn-footer btn-contained v-btn v-btn--elevated v-theme--myCustomLightTheme bg-secondary v-btn--density-default v-btn--size-default v-btn--variant-elevated contained medium" type="button"><span class="material-symbols-outlined button_icon white">add_circle</span> Save Note</button>'),ve=_('<span class="material-symbols-outlined white">visibility</span> View',1),ue=_('<span class="material-symbols-outlined white">edit</span> Edit',1),fe=_('<button class="btn-footer btn-contained v-btn v-btn--elevated v-theme--myCustomLightTheme bg-secondary v-btn--density-default v-btn--size-default v-btn--variant-elevated contained medium" type="button"><!></button>'),be=_('<img src="/assets/images/split_screen_icon_single.png" alt="single" width="24" height="24"/>'),_e=_('<img src="/assets/images/split_screen_icon_double.png" alt="double" width="24" height="24"/>'),we=_('<button class="btn-footer btn-contained split_screen_btn" type="button" aria-label="Toggle split screen"><!></button>'),ge=_("<!> <!> <!> <!> <!>",1),me=_('<div class="page_scrollable_header_breadcrumb_footer"><div id="view_container"><!> <!></div></div> <!>',1);function xe(r,e){J(e,!0);const v=Wt,n=E(()=>e.params?.notebookId),o=E(()=>e.params?.noteId);let b=T(null),S=T(null),s=T(""),x=T(""),p=T(!1),m=T(!0),u=T(!1),k=T(!1);const U=E(()=>t(o)==="create-note"),mt=E(()=>t(m)||t(u)),ht=E(()=>!t(m)||t(u)),pt=async()=>{const a=H(q).token;if(!a||!t(n))return;const i=z(await Kt(a,t(n)));i.ok&&i.data.notebook&&(c(S,i.data.notebook,!0),Dt.update(h=>({...h,edited:i.data.notebook})))},kt=async()=>{if(t(o)==="create-note"){c(s,""),c(p,!0);return}const a=H(q).token;if(!a||!t(n)||!t(o))return;const i=z(await Qt(a,t(n),t(o)));if(!i.ok){G(i.error??"Unknown error");return}i.data.note&&(c(b,i.data.note,!0),c(s,i.data.note.note,!0),c(x,i.data.note.note,!0),c(p,!0))},Q=E(()=>t(s)!==t(x)),St=async a=>{const i=H(q).token;if(!i||!t(n))return;const h=z(await Yt(i,{notebookId:t(n),note:a}));if(!h.ok){G(h.error??"Unknown error");return}jt(`/notebook/${t(n)}`)},Y=async a=>{const i=H(q).token;if(!i||!t(n)||!t(o)||t(o)==="create-note")return;const h=z(await Xt(i,t(n),t(o),a));if(!h.ok){G(h.error??"Unknown error");return}c(x,a,!0),Gt.ShowSnack({n_status:!0,message:"Note Saved"})},X=a=>{c(s,a,!0)},yt=async()=>{t(Q)&&await Y(t(s)),c(m,!t(m))},Tt=()=>{c(u,!t(u))},xt=async()=>{t(k)||c(u,!0);try{const a=await fetch("/markdown/welcome_markdown_angular.md");a.ok?c(s,await a.text(),!0):c(s,`# Example Note

Start typing your note here...`)}catch{c(s,`# Example Note

Start typing your note here...`)}},R=()=>{c(k,window.innerWidth<v.SPLITSCREEN_MINIMUM_WIDTH),t(k)&&c(u,!1)};lt(()=>{if(!t(p))return;const a=setTimeout(()=>te(),500);return()=>{clearTimeout(a),ee()}}),ct(()=>(R(),window.addEventListener("resize",R),(async()=>(await q.getAuth(),await pt(),await kt(),c(m,t(o)==="create-note")))(),()=>window.removeEventListener("resize",R)));var Z=Bt(),Nt=j(Z);{var Et=a=>{var i=se();f(a,i)},Lt=a=>{var i=me(),h=j(i),$=g(h),tt=g($);ae(tt,{get viewText(){return t(s)},onEdit:A=>X(A),get visible(){return t(ht)},get splitScreen(){return t(u)}});var Ct=C(tt,2);ie(Ct,{get loadedText(){return t(s)},onUpdate:A=>X(A),get visible(){return t(mt)},get splitScreen(){return t(u)}});var It=C(h,2);Zt(It,{children:(A,he)=>{var et=ge(),ot=j(et);{var Vt=l=>{var d=le();I("click",d,xt),f(l,d)};y(ot,l=>{t(U)&&t(s).length===0&&l(Vt)})}var nt=C(ot,2);{var Mt=l=>{var d=ce();I("click",d,()=>St(t(s))),f(l,d)};y(nt,l=>{t(U)&&t(s).length>0&&l(Mt)})}var at=C(nt,2);{var Pt=l=>{var d=de();I("click",d,()=>Y(t(s))),f(l,d)};y(at,l=>{!t(U)&&t(Q)&&l(Pt)})}var rt=C(at,2);{var Ut=l=>{var d=fe(),B=g(d);{var D=w=>{var N=ve();f(w,N)},W=w=>{var N=ue();f(w,N)};y(B,w=>{t(m)?w(D):w(W,!1)})}O(()=>dt(d,"aria-label",t(m)?"Switch to View":"Switch to Edit")),I("click",d,yt),f(l,d)};y(rt,l=>{t(u)||l(Ut)})}var At=C(rt,2);{var qt=l=>{var d=we(),B=g(d);{var D=w=>{var N=be();f(w,N)},W=w=>{var N=_e();f(w,N)};y(B,w=>{t(u)?w(D):w(W,!1)})}I("click",d,Tt),f(l,d)};y(At,l=>{t(k)||l(qt)})}f(A,et)}}),O(()=>L($,1,`view_container ${t(u)?"editnote_box_split":""}`)),f(a,i)};y(Nt,a=>{t(p)?a(Lt,!1):a(Et)})}f(r,Z),K()}vt(["click"]);export{xe as default};
