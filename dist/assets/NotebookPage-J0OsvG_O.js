const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DMQYA1Fo.js","assets/index-D8Cz9dpS.js","assets/index-fi9NzBlx.css","assets/AddNotebookForm-DS4rIbaH.js","assets/ErrorAlert-zVySHgHR.js","assets/ErrorAlert-DZvNB_QY.css","assets/vuetify-classes-DOjo5YWf.js","assets/AddNotebookForm-BtUzU4dZ.css","assets/ViewNoteMarkdown-CwzZH-Hp.js","assets/saveNote-DpGPkctZ.js","assets/addNotebook-BBQYm0J6.js","assets/changeUsername-BM6pMEGx.js","assets/FooterView-Bdj4yHij.js","assets/FooterView-DK_MiM7N.css"])))=>i.map(i=>d[i]);
import{L as F,A as lt,B as pt,p as dt,c as E,e as _,g as t,H as kt,t as et,f as st,h as it,m as T,l as Gt,q as d,n as g,a as ct,s as V,G as q,x as A,j as ht,M as Kt,b as St,N as ft,I as Ot,d as L,k as _t,O as Qt,P as Xt,v as H,E as j,J as Yt,C as rt,y as bt,Q as at,o as Zt,u as J,w as nt,D as W,R as te,S as ee,_ as oe}from"./index-D8Cz9dpS.js";import{e as Pt,b as re,D as ae,g as ne,A as se}from"./AddNotebookForm-DS4rIbaH.js";import{V as ie,m as le,g as de}from"./ViewNoteMarkdown-CwzZH-Hp.js";import{F as At}from"./FooterView-Bdj4yHij.js";import{v as Tt,b as It}from"./vuetify-classes-DOjo5YWf.js";const ce={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},ue=ce,ve=lt,_e=async(N,u)=>{let a;try{if(a=await fetch((ue.VITE_API_ENDPOINT||"")+`api/data/notes/${u}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`}}),a.status===404)throw new Error(`${a.url} Not Found.`)}catch(o){return{error:F(o)}}let i;try{if(i=await a.json(),i===null)return{error:`${ve.NOTES_ERROR}`}}catch(o){return{error:F(o)}}return i&&"error"in i&&i.error?{error:i.error}:i},be={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},fe=be,pe=lt,ke=async(N,u)=>{let a;const i={notebookID:u};try{if(a=await fetch((fe.VITE_API_ENDPOINT||"")+"api/data/delete-notebook",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify(i)}),a.status===404)throw new Error(`${a.url} Not Found.`)}catch(n){return{error:F(n)}}let o;try{if(o=await a.json(),o===null)return{error:`${pe.NOTEBOOK_DELETE_ERROR}`}}catch(n){return{error:F(n)}}return o&&"error"in o&&o.error?{error:o.error}:o},he={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},me=he,Ne=lt,we=async(N,u)=>{let a;const i={note_ids:u};try{if(a=await fetch((me.VITE_API_ENDPOINT||"")+"api/data/delete-notes",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify(i)}),a.status===404)throw new Error(`${a.url} Not Found.`)}catch(n){return{error:F(n)}}let o;try{if(o=await a.json(),o===null)return{error:`${Ne.NOTES_DELETE_ERROR}`}}catch(n){return{error:F(n)}}return o&&"error"in o&&o.error?{error:o.error}:o},ge={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_ENDPOINT:"https://www.snipbee.com/"},Ee=ge,ye=lt,De=async(N,u,a,i)=>{let o;const n={notes:a,notebookID:u,latestUpdatedNote:i};try{if(o=await fetch((Ee.VITE_API_ENDPOINT||"")+"api/data/move-notes",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify(n)}),o.status===404)throw new Error(`${o.url} Not Found.`)}catch(v){return{error:F(v)}}let k;try{if(k=await o.json(),k===null)return{error:`${ye.NOTES_ERROR}`}}catch(v){return{error:F(v)}}return k&&"error"in k&&k.error?{error:k.error}:k};var Ae=A("<option> </option>"),Se=A('<div class="modal-container svelte-1lcsh5s"><div class="modal-overlay svelte-1lcsh5s" role="button" tabindex="0" aria-label="Close dialog"></div> <div role="dialog" aria-modal="true" aria-labelledby="move-notebook-title" tabindex="-1"><div><h2 id="move-notebook-title" class="dialogue-title">Move to Notebook</h2> <form id="move-notebook-form" class="form svelte-1lcsh5s"><div class="control svelte-1lcsh5s"><label for="notebooks-select" class="svelte-1lcsh5s">Name</label> <select id="notebooks-select" class="select_dialogue svelte-1lcsh5s"><option disabled="">Select a notebook...</option><!></select></div></form> <div class="button_row svelte-1lcsh5s"><div class="action svelte-1lcsh5s"><div class="move"><button type="submit" form="move-notebook-form" class="btn-contained v-btn--size-default svelte-1lcsh5s" aria-label="Move Note button">Move Note</button></div> <div class="cancel"><button type="button" class="btn-contained v-btn--size-default svelte-1lcsh5s" aria-label="Cancel button"><span class="icon_text svelte-1lcsh5s"><span class="material-symbols-outlined button_icon white svelte-1lcsh5s">cancel</span> Cancel</span></button></div></div></div></div></div></div>');function Oe(N,u){dt(u,!0);let a=V(""),i=q(()=>t(a)!==""&&t(a)!=="default");const o=q(()=>{const s=[...u.notebooks];return s.sort((y,O)=>{const Z=y.updatedAt==="No date"||!y.updatedAt?"December 17, 1995":y.updatedAt,Q=O.updatedAt==="No date"||!O.updatedAt?"December 17, 1995":O.updatedAt;return new Date(Z)>new Date(Q)?-1:1}),s}),n=q(()=>t(o).filter(s=>s._id!==u.currentNotebookId)),k=s=>{s.preventDefault(),s.stopPropagation(),u.onCancel()},v=async s=>{s.preventDefault(),s.stopPropagation(),!(!t(a)||!t(i))&&await u.onMoveNotes(t(a))};function p(s){return s.focus(),{}}var c=Se(),h=_(c),w=E(h,2),I=_(w),$=E(_(I),2),C=_($),R=E(_(C),2),M=_(R);M.value=M.__value="";var S=E(M);Pt(S,17,()=>t(n),s=>s._id,(s,y)=>{var O=Ae(),Z=_(O),Q={};et(()=>{ht(Z,t(y).notebook_name),Q!==(Q=t(y)._id)&&(O.value=(O.__value=t(y)._id)??"")}),g(s,O)});var Y=E($,2),G=_(Y),K=_(G),z=_(K),m=E(K,2),B=_(m);kt(w,s=>p?.(s)),et((s,y)=>{it(w,1,s,"svelte-1lcsh5s"),it(I,1,y,"svelte-1lcsh5s"),z.disabled=!t(i)},[()=>st(Tt("card","modal-dialog","dialogue_container")),()=>st(It())]),T("click",h,s=>k(s)),T("keydown",h,s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),k(s))}),T("keydown",w,s=>s.key==="Escape"&&k(s)),Gt("submit",$,v),re(R,()=>t(a),s=>d(a,s)),T("click",B,k),g(N,c),ct()}pt(["click","keydown"]);function Pe(N,u=10){if(!N?.trim())return"";const a=N.split(`
`),i=[];let o=0,n=[];for(;o<a.length&&i.length<u;){const k=a[o],v=k.trim();if(v.startsWith("```")){for(n.length>0&&(i.push(n.join(`
`)),n=[]),n=[k],o++;o<a.length&&!a[o].trim().startsWith("```");)n.push(a[o]),o++;o<a.length&&(n.push(a[o]),o++),i.push(n.join(`
`)),n=[];continue}if(v===""){n.length>0&&(i.push(n.join(`
`)),n=[]),o++;continue}const p=/^#{1,6}\s/.test(v),c=/^[-*+]\s/.test(v)||/^\d+\.\s/.test(v),h=v.startsWith(">"),w=/^\|/.test(v);(p||c||h||w)&&n.length>0&&(i.push(n.join(`
`)),n=[]),n.push(k),o++}return n.length>0&&i.push(n.join(`
`)),i.slice(0,u).join(`

`)}var Te=A('<div class="box svelte-ebwjus"><article class="viewnote_content viewnote_thumb"><!></article></div>');function Ie(N,u){dt(u,!0);const a=q(()=>Pe(le(u.text).content??""));var i=Te(),o=_(i),n=_(o);ie(n,{get viewText(){return t(a)},disableLinks:!0}),g(N,i),ct()}var Re=A('<div class="thumb_select_outer svelte-uaddfd"><div class="thumb_select svelte-uaddfd"><input type="checkbox" name="Status"/></div></div>'),xe=A('<li class="notebook_list_bg svelte-uaddfd"><div class="thumb_outer svelte-uaddfd"><a class="thumb_outer_link svelte-uaddfd"><div class="edit_link svelte-uaddfd" role="button"><div><div><div class="thumb_image svelte-uaddfd"><!></div> <div class="date_format date_format_notes"> </div></div></div></div></a> <!></div></li>'),Ce=A('<ul class="notes_list svelte-uaddfd"></ul>');function $e(N,u){dt(u,!0);let a=Kt(u,"onNotesEdit",3,!1),i=V(St({})),o=!1;ft(()=>{const p=!!u.onClearNotesEdit;p&&!o&&(d(i,{},!0),u.onNotesSelected?.({selected:[]})),o=p});const n=(p,c)=>{d(i,{...t(i),[p]:c},!0);const h=Object.entries(t(i)).filter(([,w])=>w).map(([w])=>w);u.onNotesSelected?.({selected:h})},k=(p,c)=>{c.stopPropagation();const h=c.target;n(p,h.checked)};var v=Ce();Pt(v,21,()=>u.notes,p=>p._id,(p,c)=>{var h=xe(),w=_(h),I=_(w),$=_(I),C=_($),R=_(C),M=_(R),S=_(M);Ie(S,{get text(){return t(c).note}});var Y=E(M,2),G=_(Y);kt(I,m=>Ot?.(m));var K=E(I,2);{var z=m=>{var B=Re(),s=_(B),y=_(s);et(()=>{Qt(y,t(c)._id),_t(y,"id",`input_${t(c)._id??""}`),Xt(y,t(i)[t(c)._id]??!1)}),T("change",y,O=>k(t(c)._id,O)),T("click",y,O=>O.stopPropagation()),g(m,B)};L(K,m=>{a()&&m(z)})}et((m,B,s)=>{_t(I,"href",`/notebook/${t(c).notebook??""}/${t(c)._id??""}`),_t($,"tabindex",a()?0:-1),it(C,1,m,"svelte-uaddfd"),it(R,1,B,"svelte-uaddfd"),ht(G,s)},[()=>st(Tt("note_list_card")),()=>st(It("cardcontent")),()=>ae(t(c).updatedAt??"")]),T("click",I,m=>a()&&m.preventDefault()),T("click",$,m=>{a()&&(m.preventDefault(),n(t(c)._id,!t(i)[t(c)._id]))}),T("keydown",$,m=>{a()&&(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),n(t(c)._id,!t(i)[t(c)._id]))}),g(p,h)}),g(N,v),ct()}pt(["click","keydown","change"]);var Ve=A('<div class="loading_routes">Loading...</div>'),Me=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">arrow_back</span> Back to Notebooks</span></button>'),je=A('<div class="page_scrollable_header_breadcrumb_footer_list"><div class="loading_routes error-state"><p> </p> <a href="/notebooks" class="back-link">Back to Notebooks</a></div></div> <!>',1),Le=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">note_add</span> Add Note</span></button>'),Be=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">edit</span> Edit Notes</span></button>'),Ue=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">delete</span> Delete Notebook</span></button>'),He=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">delete</span> Delete</span></button>'),Fe=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white symbol_size">flip_to_front</span> Move</span></button>'),ze=A('<button class="btn-footer btn-contained"><span class="icon_text"><span class="material-symbols-outlined button_icon white">cancel</span> Cancel</span></button>'),Je=A("<!> <!> <!> <!> <!> <!>",1),We=A('<div class="page_scrollable_header_breadcrumb_footer_list"><!> <!> <!></div> <!>',1);function qe(N,u){dt(u,!0);const a=()=>bt(te,"$paramsStore",n),i=()=>bt(ee,"$location",n),o=()=>bt(at,"$notebookEditStore",n),[n,k]=Zt(),v=q(()=>{const r=(u.params??a())?.notebookId;if(r)return r;const e=i();if(e){const x=/^\/notebook\/([^/]+)/.exec(e);if(x?.[1])return x[1]}const l=typeof window<"u"?window.location.hash:"";return/#?\/notebook\/([^/]+)/.exec(l)?.[1]??null});let p=V(null),c=V(null),h=V(null),w=V(!1),I=V(!1),$=V(!1),C=V(St([])),R=V(!1),M=V(!1),S=V(null);const Y=r=>{d(C,r.selected,!0)},G=r=>{const e=r.map(l=>({...l,updatedAt:l.updatedAt==="No date"||!l.updatedAt?"December 17, 1995 03:24:00":l.updatedAt}));return e.sort((l,b)=>new Date(l.updatedAt)>new Date(b.updatedAt)?1:-1),e.reverse()},K=async r=>{try{const e=J(H).token;if(!e){d(S,"Session expired. Redirecting to login."),d(I,!0),nt("/login");return}const l=W(await de(e,r));if(!l.ok){j(l.error??"Unknown error"),d(S,l.error??null,!0),d(I,!0);return}l.data.notebook&&(d(c,l.data.notebook,!0),at.update(b=>({...b,edited:l.data.notebook})))}catch(e){d(S,e instanceof Error?e.message:String(e),!0),j(t(S))}finally{d(I,!0)}},z=async r=>{try{const e=J(H).token;if(!e){d(w,!0);return}const l=W(await _e(e,r));if(!l.ok)j(l.error??"Unknown error"),d(S,l.error??null,!0);else if(l.data.notes){const b=Array.isArray(l.data.notes)?l.data.notes:[];d(p,G(b),!0)}else d(p,[],!0)}catch(e){d(S,e instanceof Error?e.message:String(e),!0),j(t(S))}finally{d(w,!0)}},m=async()=>{try{const r=J(H).token;if(!r)return;const e=W(await ne(r));if(!e.ok){j(e.error??"Unknown error");return}e.data.notebooks?d(h,Array.isArray(e.data.notebooks)?e.data.notebooks:[],!0):d(h,[],!0)}catch(r){j(r instanceof Error?r.message:String(r))}},B=()=>{t(v)&&nt(`/notebook/${t(v)}/create-note`)},s=async()=>{if(!confirm("Delete this notebook?"))return;const r=J(H).token;if(!r||!t(v))return;const e=W(await ke(r,t(v)));if(!e.ok){j(e.error??"Unknown error");return}nt("/notebooks")},y=()=>{d(R,!0)},O=()=>{d(R,!1),d(C,[],!0)},Z=()=>{d(M,!0)},Q=()=>{d(M,!1)},Rt=async()=>{if(t(C).length===0)return;const r=J(H).token;if(!r)return;const e=W(await we(r,t(C)));if(!e.ok){j(e.error??"Unknown error");return}O(),t(v)&&await z(t(v))},xt=()=>{d($,!1),at.update(r=>({...r,editing:!1}))},Ct=async(r,e)=>{const l=J(H).token;if(!l||!t(c))return;const{editNotebook:b}=await oe(async()=>{const{editNotebook:U}=await import("./index-DMQYA1Fo.js");return{editNotebook:U}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13])),x=W(await b(l,t(c)._id,r,e,new Date().toISOString()));if(!x.ok){j(x.error??"Unknown error");return}x.data.notebook_edited&&(d(c,x.data.notebook_edited,!0),at.update(U=>({...U,edited:x.data.notebook_edited,editing:!1})),d($,!1))},$t=r=>{const e=r.map(b=>t(p)?.find(x=>x._id===b)).filter(Boolean);return G(e)[0]?.updatedAt},Vt=async r=>{const e=J(H).token;if(!e||!t(v)||t(C).length===0)return;const l=$t(t(C)),b=W(await De(e,r,t(C),l));if(!b.ok){j(b.error??"Unknown error");return}b.ok&&(d(M,!1),O(),t(v)&&await z(t(v)))};ft(()=>{o()?.editing&&d($,!0)}),ft(()=>{const r=t(v);if(!r)return;d(w,!1),d(I,!1),d(S,null);let e=!1;return(async()=>{try{if(await H.getAuth(),e)return;await Promise.all([K(r),z(r),m()])}catch(b){e||(d(S,b instanceof Error?b.message:String(b),!0),j(t(S)),d(w,!0),d(I,!0))}})(),()=>{e=!0}});var mt=Yt(),Mt=rt(mt);{var jt=r=>{var e=Ve();g(r,e)},Lt=r=>{var e=je(),l=rt(e),b=_(l),x=_(b),U=_(x),ut=E(x,2);kt(ut,tt=>Ot?.(tt));var vt=E(l,2);At(vt,{children:(tt,Nt)=>{var P=Me();T("click",P,()=>nt("/notebooks")),g(tt,P)}}),et(()=>ht(U,t(S))),g(r,e)},Bt=r=>{var e=We(),l=rt(e),b=_(l);{var x=P=>{{let ot=q(()=>t(p)??[]),X=q(()=>!t(R));$e(P,{get notes(){return t(ot)},onNotesSelected:Y,get onNotesEdit(){return t(R)},get onClearNotesEdit(){return t(X)}})}};L(b,P=>{t(c)&&t(p)!==null&&P(x)})}var U=E(b,2);{var ut=P=>{Oe(P,{get notebooks(){return t(h)},get currentNotebookId(){return t(v)},onMoveNotes:Vt,onCancel:Q})};L(U,P=>{t(M)&&t(h)&&P(ut)})}var vt=E(U,2);{var tt=P=>{se(P,{method:"edit",get notebook(){return t(c)},onAddNotebook:async(ot,X)=>await Ct(ot,X),onCancel:xt})};L(vt,P=>{t($)&&t(c)&&P(tt)})}var Nt=E(l,2);At(Nt,{children:(P,ot)=>{var X=Je(),wt=rt(X);{var Ut=f=>{var D=Le();T("click",D,B),g(f,D)};L(wt,f=>{t(R)||f(Ut)})}var gt=E(wt,2);{var Ht=f=>{var D=Be();T("click",D,y),g(f,D)};L(gt,f=>{!t(R)&&(t(p)??[]).length>0&&f(Ht)})}var Et=E(gt,2);{var Ft=f=>{var D=Ue();T("click",D,s),g(f,D)};L(Et,f=>{(t(p)??[]).length<1&&f(Ft)})}var yt=E(Et,2);{var zt=f=>{var D=He();T("click",D,Rt),g(f,D)};L(yt,f=>{t(R)&&t(C).length>0&&f(zt)})}var Dt=E(yt,2);{var Jt=f=>{var D=Fe();T("click",D,Z),g(f,D)};L(Dt,f=>{t(R)&&t(C).length>0&&t(h)&&t(h).length>1&&f(Jt)})}var Wt=E(Dt,2);{var qt=f=>{var D=ze();T("click",D,O),g(f,D)};L(Wt,f=>{t(R)&&f(qt)})}g(P,X)}}),g(r,e)};L(Mt,r=>{!t(I)||!t(w)?r(jt):t(S)?r(Lt,1):r(Bt,!1)})}g(N,mt),ct(),k()}pt(["click"]);const Ze=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"}));export{Ze as N,we as a,ke as d,_e as g,De as m};
